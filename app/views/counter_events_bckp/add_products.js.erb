<% if params[:counter_event_type].present? && params[:counter_event_type].eql?("cash discount") %>
  <% if @counter_event.new_record? %>
    if($("#listing_counter_event_warehouse_products_table_<%= params[:warehouse_id] %>_cash_discount").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-cash-discount").html("<%= j(render(partial: "listing_warehouse_products")) %>");
    }else{
    <% counter_event_warehouse = @counter_event.counter_event_warehouses.select{|ew| ew.warehouse_id == params[:warehouse_id].to_i}.first %>
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventWarehouseProductDataTablesCashDiscount['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      counter_eventWarehouseProductDataTablesCashDiscount['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_cash_discount');
      <% counter_event_product = counter_event_warehouse.counter_event_products.select{|ep| ep.product_id == product.id}.first %>
      $("#counter_event_product_fields_container_<%= params[:warehouse_id] %>_cash_discount").append("<%= j(render(partial: "counter_event_product_fields", locals: {warehouse_id: params[:warehouse_id], counter_event_product: counter_event_product, counter_event_type: params[:counter_event_type]})) %>");
    <% end %>
    }
  <% else %>
    <% counter_event_warehouse = @counter_event_warehouse %>
    if($("#listing_counter_event_warehouse_products_table_<%= params[:warehouse_id] %>_cash_discount").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-cash-discount").html("<%= j(render(partial: "listing_warehouse_products", locals: {counter_event_warehouse: counter_event_warehouse})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventWarehouseProductDataTablesCashDiscount['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      counter_eventWarehouseProductDataTablesCashDiscount['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_cash_discount');            
      if($("#cash_discount_counter_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").length > 0)
      $("#cash_discount_counter_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").val("false");
      else{
      <% counter_event_product = @existing_counter_event_new_products.select{|ep| ep.product_id == product.id}.first %>
      <% if counter_event_product.present? %>
        $("#counter_event_product_fields_container_<%= params[:warehouse_id] %>_cash_discount").append("<%= j(render(partial: "counter_event_product_fields", locals: {warehouse_id: params[:warehouse_id], counter_event_product: counter_event_product, counter_event_type: params[:counter_event_type]})) %>");
      <% end %>
      }
    <% end %>
    }
  <% end %>
<% elsif params[:counter_event_type].present? && params[:counter_event_type].eql?("special price") %>
  <% if @counter_event.new_record? %>
    if($("#listing_counter_event_warehouse_products_table_<%= params[:warehouse_id] %>_special_price").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-special-price").html("<%= j(render(partial: "listing_warehouse_products")) %>");
    }else{
    <% counter_event_warehouse = @counter_event.counter_event_warehouses.select{|ew| ew.warehouse_id == params[:warehouse_id].to_i}.first %>
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventWarehouseProductDataTablesSpecialPrice['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      counter_eventWarehouseProductDataTablesSpecialPrice['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_special_price');
      <% counter_event_product = counter_event_warehouse.counter_event_products.select{|ep| ep.product_id == product.id}.first %>
      $("#counter_event_product_fields_container_<%= params[:warehouse_id] %>_special_price").append("<%= j(render(partial: "counter_event_product_fields", locals: {warehouse_id: params[:warehouse_id], counter_event_product: counter_event_product, counter_event_type: params[:counter_event_type]})) %>");
    <% end %>
    }
  <% else %>
    <% counter_event_warehouse = @counter_event_warehouse %>
    if($("#listing_counter_event_warehouse_products_table_<%= params[:warehouse_id] %>_special_price").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-special-price").html("<%= j(render(partial: "listing_warehouse_products", locals: {counter_event_warehouse: counter_event_warehouse})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventWarehouseProductDataTablesSpecialPrice['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      counter_eventWarehouseProductDataTablesSpecialPrice['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_special_price');            
      if($("#special_price_counter_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").length > 0)
      $("#special_price_counter_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").val("false");
      else{
      <% counter_event_product = @existing_counter_event_new_products.select{|ep| ep.product_id == product.id}.first %>
      <% if counter_event_product.present? %>
        $("#counter_event_product_fields_container_<%= params[:warehouse_id] %>_special_price").append("<%= j(render(partial: "counter_event_product_fields", locals: {warehouse_id: params[:warehouse_id], counter_event_product: counter_event_product, counter_event_type: params[:counter_event_type]})) %>");
      <% end %>
      }
    <% end %>
    }
  <% end %>
<% elsif params[:counter_event_type].present? && params[:counter_event_type].eql?("buy one get one") %>
  <% if @counter_event.new_record? %>
    if($("#listing_counter_event_warehouse_products_table_<%= params[:warehouse_id] %>_buy_one_get_one").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-buy-one-get-one").html("<%= j(render(partial: "listing_warehouse_products")) %>");
    }else{
    <% counter_event_warehouse = @counter_event.counter_event_warehouses.select{|ew| ew.warehouse_id == params[:warehouse_id].to_i}.first %>
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventWarehouseProductDataTablesBuyOneGetOne['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      counter_eventWarehouseProductDataTablesBuyOneGetOne['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_buy_one_get_one');
      <% counter_event_product = counter_event_warehouse.counter_event_products.select{|ep| ep.product_id == product.id}.first %>
      $("#counter_event_product_fields_container_<%= params[:warehouse_id] %>_buy_one_get_one").append("<%= j(render(partial: "counter_event_product_fields", locals: {warehouse_id: params[:warehouse_id], counter_event_product: counter_event_product, counter_event_type: params[:counter_event_type]})) %>");
    <% end %>
    }
  <% else %>
    <% counter_event_warehouse = @counter_event_warehouse %>
    if($("#listing_counter_event_warehouse_products_table_<%= params[:warehouse_id] %>_buy_one_get_one").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-buy-one-get-one").html("<%= j(render(partial: "listing_warehouse_products", locals: {counter_event_warehouse: counter_event_warehouse})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventWarehouseProductDataTablesBuyOneGetOne['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      counter_eventWarehouseProductDataTablesBuyOneGetOne['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_buy_one_get_one');
      if($("#buy_one_get_one_counter_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").length > 0)
      $("#buy_one_get_one_counter_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").val("false");
      else{
      <% counter_event_product = @existing_counter_event_new_products.select{|ep| ep.product_id == product.id}.first %>
      <% if counter_event_product.present? %>
        $("#counter_event_product_fields_container_<%= params[:warehouse_id] %>_buy_one_get_one").append("<%= j(render(partial: "counter_event_product_fields", locals: {warehouse_id: params[:warehouse_id], counter_event_product: counter_event_product, counter_event_type: params[:counter_event_type]})) %>");
      <% end %>
      }
    <% end %>
    }
  <% end %>
<% elsif params[:counter_event_type].present? && params[:counter_event_type].eql?("gift") %>
  <% if @counter_event.new_record? %>
    if($("#listing_counter_event_warehouse_products_table_<%= params[:warehouse_id] %>_gift").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-gift").html("<%= j(render(partial: "listing_warehouse_products")) %>");
    }else{
    <% counter_event_warehouse = @counter_event.counter_event_warehouses.select{|ew| ew.warehouse_id == params[:warehouse_id].to_i}.first %>
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventWarehouseProductDataTablesGift['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      counter_eventWarehouseProductDataTablesGift['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_gift');
      <% counter_event_product = counter_event_warehouse.counter_event_products.select{|ep| ep.product_id == product.id}.first %>
      $("#counter_event_product_fields_container_<%= params[:warehouse_id] %>_gift").append("<%= j(render(partial: "counter_event_product_fields", locals: {warehouse_id: params[:warehouse_id], counter_event_product: counter_event_product, counter_event_type: params[:counter_event_type]})) %>");
    <% end %>
    }
  <% else %>
    <% counter_event_warehouse = @counter_event_warehouse %>
    if($("#listing_counter_event_warehouse_products_table_<%= params[:warehouse_id] %>_gift").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-gift").html("<%= j(render(partial: "listing_warehouse_products", locals: {counter_event_warehouse: counter_event_warehouse})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventWarehouseProductDataTablesGift['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      counter_eventWarehouseProductDataTablesGift['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_gift');
      if($("#gift_counter_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").length > 0)
      $("#gift_counter_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").val("false");
      else{
      <% counter_event_product = @existing_counter_event_new_products.select{|ep| ep.product_id == product.id}.first %>
      <% if counter_event_product.present? %>
        $("#counter_event_product_fields_container_<%= params[:warehouse_id] %>_gift").append("<%= j(render(partial: "counter_event_product_fields", locals: {warehouse_id: params[:warehouse_id], counter_event_product: counter_event_product, counter_event_type: params[:counter_event_type]})) %>");
      <% end %>
      }
    <% end %>
    }
  <% end %>
<% else %>
  <% if @counter_event.new_record? %>
    if($("#listing_counter_event_warehouse_products_table_<%= params[:warehouse_id] %>").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products").html("<%= j(render(partial: "listing_warehouse_products")) %>");
    }else{
    <% counter_event_warehouse = @counter_event.counter_event_warehouses.select{|ew| ew.warehouse_id == params[:warehouse_id].to_i}.first %>
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventWarehouseProductDataTables['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      counter_eventWarehouseProductDataTables['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>');
      <% counter_event_product = counter_event_warehouse.counter_event_products.select{|ep| ep.product_id == product.id}.first %>
      $("#counter_event_product_fields_container_<%= params[:warehouse_id] %>").append("<%= j(render(partial: "counter_event_product_fields", locals: {warehouse_id: params[:warehouse_id], counter_event_product: counter_event_product, counter_event_type: params[:counter_event_type]})) %>");
    <% end %>
    }  
  <% else %>
    <% counter_event_warehouse = @counter_event_warehouse %>
    if($("#listing_counter_event_warehouse_products_table_<%= params[:warehouse_id] %>").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products").html("<%= j(render(partial: "listing_warehouse_products", locals: {counter_event_warehouse: counter_event_warehouse})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventWarehouseProductDataTables['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      counter_eventWarehouseProductDataTables['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>');            
      if($("#counter_event_counter_event_warehouses_attributes_<%= params[:warehouse_id] %>_counter_event_products_attributes_<%= product.id %>__destroy").length > 0)
      $("#counter_event_counter_event_warehouses_attributes_<%= params[:warehouse_id] %>_counter_event_products_attributes_<%= product.id %>__destroy").val("false");
      else{
      <% counter_event_product = @existing_counter_event_new_products.select{|ep| ep.product_id == product.id}.first %>
      <% if counter_event_product.present? %>
        $("#counter_event_product_fields_container_<%= params[:warehouse_id] %>").append("<%= j(render(partial: "counter_event_product_fields", locals: {warehouse_id: params[:warehouse_id], counter_event_product: counter_event_product, counter_event_type: params[:counter_event_type]})) %>");
      <% end %>
      }
    <% end %>
    }
  <% end %>
<% end %>
