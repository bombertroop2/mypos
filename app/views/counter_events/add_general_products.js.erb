<% if params[:counter_event_type].present? && params[:counter_event_type].eql?("cash discount") %>
  <% if @counter_event.new_record? %>
    if($("#listing_counter_event_general_products_table_cash_discount").length == 0){
    $("#listing-general-products-cash-discount").html("<%= j(render(partial: "listing_general_products", locals: {counter_event_general_products: @existing_counter_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventGeneralProductDataTablesCashDiscount.row.add(rowValue).draw(false);
      counter_eventGeneralProductDataTablesCashDiscount.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_cash_discount_<%= product.id %>');
      <% counter_event_general_product = @counter_event.counter_event_general_products.select{|ep| ep.product_id == product.id}.first %>
      $("#counter_event_general_product_fields_container_cash_discount").append("<%= j(render(partial: "counter_event_general_product_fields", locals: {counter_event_general_product: counter_event_general_product, counter_event_type: params[:counter_event_type]})) %>");
    <% end %>
    }  
  <% else %>
    if($("#listing_counter_event_general_products_table_cash_discount").length == 0){
    $("#listing-general-products-cash-discount").html("<%= j(render(partial: "listing_general_products", locals: {counter_event_general_products: @existing_counter_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventGeneralProductDataTablesCashDiscount.row.add(rowValue).draw(false);
      counter_eventGeneralProductDataTablesCashDiscount.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_cash_discount_<%= product.id %>');
      <% counter_event_general_product = @existing_counter_event_new_general_products.select{|ep| ep.product_id == product.id}.first %>
      <% if counter_event_general_product.present? %>
        $("#counter_event_general_product_fields_container_cash_discount").append("<%= j(render(partial: "counter_event_general_product_fields", locals: {counter_event_general_product: counter_event_general_product, counter_event_type: params[:counter_event_type]})) %>");
      <% end %>
    <% end %>
    }
  <% end %>
<% elsif params[:counter_event_type].present? && params[:counter_event_type].eql?("special price") %>
  <% if @counter_event.new_record? %>
    if($("#listing_counter_event_general_products_table_special_price").length == 0){
    $("#listing-general-products-special-price").html("<%= j(render(partial: "listing_general_products", locals: {counter_event_general_products: @existing_counter_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventGeneralProductDataTablesSpecialPrice.row.add(rowValue).draw(false);
      counter_eventGeneralProductDataTablesSpecialPrice.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_special_price_<%= product.id %>');
      <% counter_event_general_product = @counter_event.counter_event_general_products.select{|ep| ep.product_id == product.id}.first %>
      $("#counter_event_general_product_fields_container_special_price").append("<%= j(render(partial: "counter_event_general_product_fields", locals: {counter_event_general_product: counter_event_general_product, counter_event_type: params[:counter_event_type]})) %>");
    <% end %>
    }  
  <% else %>
    if($("#listing_counter_event_general_products_table_special_price").length == 0){
    $("#listing-general-products-special-price").html("<%= j(render(partial: "listing_general_products", locals: {counter_event_general_products: @existing_counter_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventGeneralProductDataTablesSpecialPrice.row.add(rowValue).draw(false);
      counter_eventGeneralProductDataTablesSpecialPrice.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_special_price_<%= product.id %>');
      <% counter_event_general_product = @existing_counter_event_new_general_products.select{|ep| ep.product_id == product.id}.first %>
      <% if counter_event_general_product.present? %>
        $("#counter_event_general_product_fields_container_special_price").append("<%= j(render(partial: "counter_event_general_product_fields", locals: {counter_event_general_product: counter_event_general_product, counter_event_type: params[:counter_event_type]})) %>");
      <% end %>
    <% end %>
    }
  <% end %>
<% elsif params[:counter_event_type].present? && params[:counter_event_type].eql?("buy one get one") %>
  <% if @counter_event.new_record? %>
    if($("#listing_counter_event_general_products_table_buy_one_get_one").length == 0){
    $("#listing-general-products-buy-one-get-one").html("<%= j(render(partial: "listing_general_products", locals: {counter_event_general_products: @existing_counter_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventGeneralProductDataTablesBuyOneGetOne.row.add(rowValue).draw(false);
      counter_eventGeneralProductDataTablesBuyOneGetOne.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_bo_go_<%= product.id %>');
      <% counter_event_general_product = @counter_event.counter_event_general_products.select{|ep| ep.product_id == product.id}.first %>
      $("#counter_event_general_product_fields_container_buy_one_get_one").append("<%= j(render(partial: "counter_event_general_product_fields", locals: {counter_event_general_product: counter_event_general_product, counter_event_type: params[:counter_event_type]})) %>");
    <% end %>
    }  
  <% else %>
    if($("#listing_counter_event_general_products_table_buy_one_get_one").length == 0){
    $("#listing-general-products-buy-one-get-one").html("<%= j(render(partial: "listing_general_products", locals: {counter_event_general_products: @existing_counter_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventGeneralProductDataTablesBuyOneGetOne.row.add(rowValue).draw(false);
      counter_eventGeneralProductDataTablesBuyOneGetOne.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_bo_go_<%= product.id %>');
      <% counter_event_general_product = @existing_counter_event_new_general_products.select{|ep| ep.product_id == product.id}.first %>
      <% if counter_event_general_product.present? %>
        $("#counter_event_general_product_fields_container_buy_one_get_one").append("<%= j(render(partial: "counter_event_general_product_fields", locals: {counter_event_general_product: counter_event_general_product, counter_event_type: params[:counter_event_type]})) %>");
      <% end %>
    <% end %>
    }
  <% end %>
<% elsif params[:counter_event_type].present? && params[:counter_event_type].eql?("gift") %>
  <% if @counter_event.new_record? %>
    if($("#listing_counter_event_general_products_table_gift").length == 0){
    $("#listing-general-products-gift").html("<%= j(render(partial: "listing_general_products", locals: {counter_event_general_products: @existing_counter_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventGeneralProductDataTablesGift.row.add(rowValue).draw(false);
      counter_eventGeneralProductDataTablesGift.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_gift_counter_event_<%= product.id %>');
      <% counter_event_general_product = @counter_event.counter_event_general_products.select{|ep| ep.product_id == product.id}.first %>
      $("#counter_event_general_product_fields_container_gift").append("<%= j(render(partial: "counter_event_general_product_fields", locals: {counter_event_general_product: counter_event_general_product, counter_event_type: params[:counter_event_type]})) %>");
    <% end %>
    }
  <% else %>
    if($("#listing_counter_event_general_products_table_gift").length == 0){
    $("#listing-general-products-gift").html("<%= j(render(partial: "listing_general_products", locals: {counter_event_general_products: @existing_counter_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventGeneralProductDataTablesGift.row.add(rowValue).draw(false);
      counter_eventGeneralProductDataTablesGift.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_gift_counter_event_<%= product.id %>');
      <% counter_event_general_product = @existing_counter_event_new_general_products.select{|ep| ep.product_id == product.id}.first %>
      <% if counter_event_general_product.present? %>
        $("#counter_event_general_product_fields_container_gift").append("<%= j(render(partial: "counter_event_general_product_fields", locals: {counter_event_general_product: counter_event_general_product, counter_event_type: params[:counter_event_type]})) %>");
      <% end %>
    <% end %>
    }
  <% end %>
<% else %>
  <% if @counter_event.new_record? %>
    if($("#listing_counter_event_general_products_table_percentage_discount").length == 0){
    $("#listing-general-products-percentage-discount").html("<%= j(render(partial: "listing_general_products", locals: {counter_event_general_products: @existing_counter_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventGeneralProductDataTablesPercentageDiscount.row.add(rowValue).draw(false);
      counter_eventGeneralProductDataTablesPercentageDiscount.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_percentage_discount_<%= product.id %>');
      <% counter_event_general_product = @counter_event.counter_event_general_products.select{|ep| ep.product_id == product.id}.first %>
      $("#counter_event_general_product_fields_container_percentage_discount").append("<%= j(render(partial: "counter_event_general_product_fields", locals: {counter_event_general_product: counter_event_general_product, counter_event_type: params[:counter_event_type]})) %>");
    <% end %>
    }  
  <% else %>
    if($("#listing_counter_event_general_products_table_percentage_discount").length == 0){
    $("#listing-general-products-percentage-discount").html("<%= j(render(partial: "listing_general_products", locals: {counter_event_general_products: @existing_counter_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = counter_eventGeneralProductDataTablesPercentageDiscount.row.add(rowValue).draw(false);
      counter_eventGeneralProductDataTablesPercentageDiscount.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_percentage_discount_<%= product.id %>');
      <% counter_event_general_product = @existing_counter_event_new_general_products.select{|ep| ep.product_id == product.id}.first %>
      <% if counter_event_general_product.present? %>
        $("#counter_event_general_product_fields_container_percentage_discount").append("<%= j(render(partial: "counter_event_general_product_fields", locals: {counter_event_general_product: counter_event_general_product, counter_event_type: params[:counter_event_type]})) %>");
      <% end %>
    <% end %>
    }
  <% end %>
<% end %>
