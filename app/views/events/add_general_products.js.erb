<% if params[:event_type].present? && params[:event_type].eql?("cash discount") %>
  <% if @event.new_record? %>
    if($("#listing_event_warehouse_products_table_<%= params[:warehouse_id] %>_cash_discount").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-cash-discount").html("<%= j(render(partial: "listing_warehouse_products")) %>");
    }else{
    <% event_warehouse = @event.event_warehouses.select{|ew| ew.warehouse_id == params[:warehouse_id].to_i}.first %>
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = eventWarehouseProductDataTablesCashDiscount['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      eventWarehouseProductDataTablesCashDiscount['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_cash_discount');
      <% event_product = event_warehouse.event_products.select{|ep| ep.product_id == product.id}.first %>
      $("#event_product_fields_container_<%= params[:warehouse_id] %>_cash_discount").append("<%= j(render(partial: "event_product_fields", locals: {warehouse_id: params[:warehouse_id], event_product: event_product, event_type: params[:event_type]})) %>");
    <% end %>
    }
  <% else %>
    <% event_warehouse = @event_warehouse %>
    if($("#listing_event_warehouse_products_table_<%= params[:warehouse_id] %>_cash_discount").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-cash-discount").html("<%= j(render(partial: "listing_warehouse_products", locals: {event_warehouse: event_warehouse})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = eventWarehouseProductDataTablesCashDiscount['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      eventWarehouseProductDataTablesCashDiscount['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_cash_discount');            
      if($("#cash_discount_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").length > 0)
      $("#cash_discount_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").val("false");
      else{
      <% event_product = @existing_event_new_products.select{|ep| ep.product_id == product.id}.first %>
      <% if event_product.present? %>
        $("#event_product_fields_container_<%= params[:warehouse_id] %>_cash_discount").append("<%= j(render(partial: "event_product_fields", locals: {warehouse_id: params[:warehouse_id], event_product: event_product, event_type: params[:event_type]})) %>");
      <% end %>
      }
    <% end %>
    }
  <% end %>
<% elsif params[:event_type].present? && params[:event_type].eql?("special price") %>
  <% if @event.new_record? %>
    if($("#listing_event_warehouse_products_table_<%= params[:warehouse_id] %>_special_price").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-special-price").html("<%= j(render(partial: "listing_warehouse_products")) %>");
    }else{
    <% event_warehouse = @event.event_warehouses.select{|ew| ew.warehouse_id == params[:warehouse_id].to_i}.first %>
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = eventWarehouseProductDataTablesSpecialPrice['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      eventWarehouseProductDataTablesSpecialPrice['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_special_price');
      <% event_product = event_warehouse.event_products.select{|ep| ep.product_id == product.id}.first %>
      $("#event_product_fields_container_<%= params[:warehouse_id] %>_special_price").append("<%= j(render(partial: "event_product_fields", locals: {warehouse_id: params[:warehouse_id], event_product: event_product, event_type: params[:event_type]})) %>");
    <% end %>
    }
  <% else %>
    <% event_warehouse = @event_warehouse %>
    if($("#listing_event_warehouse_products_table_<%= params[:warehouse_id] %>_special_price").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-special-price").html("<%= j(render(partial: "listing_warehouse_products", locals: {event_warehouse: event_warehouse})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = eventWarehouseProductDataTablesSpecialPrice['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      eventWarehouseProductDataTablesSpecialPrice['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_special_price');            
      if($("#special_price_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").length > 0)
      $("#special_price_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").val("false");
      else{
      <% event_product = @existing_event_new_products.select{|ep| ep.product_id == product.id}.first %>
      <% if event_product.present? %>
        $("#event_product_fields_container_<%= params[:warehouse_id] %>_special_price").append("<%= j(render(partial: "event_product_fields", locals: {warehouse_id: params[:warehouse_id], event_product: event_product, event_type: params[:event_type]})) %>");
      <% end %>
      }
    <% end %>
    }
  <% end %>
<% elsif params[:event_type].present? && params[:event_type].eql?("buy one get one") %>
  <% if @event.new_record? %>
    if($("#listing_event_warehouse_products_table_<%= params[:warehouse_id] %>_buy_one_get_one").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-buy-one-get-one").html("<%= j(render(partial: "listing_warehouse_products")) %>");
    }else{
    <% event_warehouse = @event.event_warehouses.select{|ew| ew.warehouse_id == params[:warehouse_id].to_i}.first %>
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = eventWarehouseProductDataTablesBuyOneGetOne['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      eventWarehouseProductDataTablesBuyOneGetOne['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_buy_one_get_one');
      <% event_product = event_warehouse.event_products.select{|ep| ep.product_id == product.id}.first %>
      $("#event_product_fields_container_<%= params[:warehouse_id] %>_buy_one_get_one").append("<%= j(render(partial: "event_product_fields", locals: {warehouse_id: params[:warehouse_id], event_product: event_product, event_type: params[:event_type]})) %>");
    <% end %>
    }
  <% else %>
    <% event_warehouse = @event_warehouse %>
    if($("#listing_event_warehouse_products_table_<%= params[:warehouse_id] %>_buy_one_get_one").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-buy-one-get-one").html("<%= j(render(partial: "listing_warehouse_products", locals: {event_warehouse: event_warehouse})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = eventWarehouseProductDataTablesBuyOneGetOne['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      eventWarehouseProductDataTablesBuyOneGetOne['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_buy_one_get_one');
      if($("#buy_one_get_one_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").length > 0)
      $("#buy_one_get_one_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").val("false");
      else{
      <% event_product = @existing_event_new_products.select{|ep| ep.product_id == product.id}.first %>
      <% if event_product.present? %>
        $("#event_product_fields_container_<%= params[:warehouse_id] %>_buy_one_get_one").append("<%= j(render(partial: "event_product_fields", locals: {warehouse_id: params[:warehouse_id], event_product: event_product, event_type: params[:event_type]})) %>");
      <% end %>
      }
    <% end %>
    }
  <% end %>
<% elsif params[:event_type].present? && params[:event_type].eql?("gift") %>
  <% if @event.new_record? %>
    if($("#listing_event_warehouse_products_table_<%= params[:warehouse_id] %>_gift").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-gift").html("<%= j(render(partial: "listing_warehouse_products")) %>");
    }else{
    <% event_warehouse = @event.event_warehouses.select{|ew| ew.warehouse_id == params[:warehouse_id].to_i}.first %>
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = eventWarehouseProductDataTablesGift['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      eventWarehouseProductDataTablesGift['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_gift');
      <% event_product = event_warehouse.event_products.select{|ep| ep.product_id == product.id}.first %>
      $("#event_product_fields_container_<%= params[:warehouse_id] %>_gift").append("<%= j(render(partial: "event_product_fields", locals: {warehouse_id: params[:warehouse_id], event_product: event_product, event_type: params[:event_type]})) %>");
    <% end %>
    }
  <% else %>
    <% event_warehouse = @event_warehouse %>
    if($("#listing_event_warehouse_products_table_<%= params[:warehouse_id] %>_gift").length == 0){
    $("#listing-warehouse-<%= params[:warehouse_id] %>-products-gift").html("<%= j(render(partial: "listing_warehouse_products", locals: {event_warehouse: event_warehouse})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = eventWarehouseProductDataTablesGift['<%= params[:warehouse_id] %>'].row.add(rowValue).draw(false);
      eventWarehouseProductDataTablesGift['<%= params[:warehouse_id] %>'].rows(rowObject.index()).nodes().to$().attr("id", 'warehouse_<%= params[:warehouse_id] %>_product_<%= product.id %>_gift');
      if($("#gift_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").length > 0)
      $("#gift_event_product_destroy_<%= params[:warehouse_id] %>_<%= product.id %>").val("false");
      else{
      <% event_product = @existing_event_new_products.select{|ep| ep.product_id == product.id}.first %>
      <% if event_product.present? %>
        $("#event_product_fields_container_<%= params[:warehouse_id] %>_gift").append("<%= j(render(partial: "event_product_fields", locals: {warehouse_id: params[:warehouse_id], event_product: event_product, event_type: params[:event_type]})) %>");
      <% end %>
      }
    <% end %>
    }
  <% end %>
<% else %>
  <% if @event.new_record? %>
    if($("#listing_event_general_products_table_percentage_discount").length == 0){
    $("#listing-general-products-percentage-discount").html("<%= j(render(partial: "listing_general_products", locals: {event_general_products: @existing_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = eventGeneralProductDataTablesPercentageDiscount.row.add(rowValue).draw(false);
      eventGeneralProductDataTablesPercentageDiscount.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_percentage_discount_<%= product.id %>');
      <% event_general_product = @event.event_general_products.select{|ep| ep.product_id == product.id}.first %>
      $("#event_general_product_fields_container_percentage_discount").append("<%= j(render(partial: "event_general_product_fields", locals: {event_general_product: event_general_product, event_type: params[:event_type]})) %>");
    <% end %>
    }  
  <% else %>
    if($("#listing_event_general_products_table_percentage_discount").length == 0){
    $("#listing-general-products-percentage-discount").html("<%= j(render(partial: "listing_general_products", locals: {event_general_products: @existing_event_new_general_products})) %>");
    }else{
    <% @products.each do |product| %>
      var rowValue = {
      'code': '<%= product.product_code %>',
      'name': '<%= product.product_name %>'
      };
      var rowObject = eventGeneralProductDataTablesPercentageDiscount.row.add(rowValue).draw(false);
      eventGeneralProductDataTablesPercentageDiscount.rows(rowObject.index()).nodes().to$().attr("id", 'general_product_percentage_discount_<%= product.id %>');
      <% event_general_product = @existing_event_new_general_products.select{|ep| ep.product_id == product.id}.first %>
      <% if event_general_product.present? %>
        $("#event_general_product_fields_container_percentage_discount").append("<%= j(render(partial: "event_general_product_fields", locals: {event_general_product: event_general_product, event_type: params[:event_type]})) %>");
      <% end %>
    <% end %>
    }
  <% end %>
<% end %>
