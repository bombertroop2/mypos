<td colspan="4">
    <div style="padding-top: 20px"></div>
    <% if !params[:action].eql?("edit") && !params[:action].eql?("update") %>
      <div class="form-horizontal">
          <div class="form-group">
              <%= label_tag "product_id", "Product", class: "col-sm-2 control-label" %>
                <div class="col-sm-10">
                    <table id="listing_products_table" class="display" width="100%">
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Brand</th>
                            </tr>
                        </thead>

                        <tbody>
                            <% @products.each do |product| %>                                                      
                              <tr id="product_<%= product.id %>">
                                  <td><%= product.code %></td>
                                  <td><%= product.name %></td>
                              </tr>
                            <% end %>
                        </tbody>
                    </table>
    <%#= select_tag "product_id", options_from_collection_for_select(@products, :id, :code, (@product.id.to_s rescue nil)), {prompt: "Please select", class: "form-control"} %>
                </div>
            </div>
            <div id="cost-form-container">
                <% if params[:product].present? %>
                  <%= render "cost_form" %>
                <% else %>
                  <div class="form-group">
                      <div class="col-sm-offset-2 col-sm-10">
                          <button class="btn btn-primary disabled" id="btn-save-cost-form">Save</button>
                          <button class="btn btn-link cancel">Cancel</button>
                      </div>
                  </div>
                <% end %>
            </div>
        </div>
      <% else %>
        <%= render "cost_form" %>
      <% end %>
  </td>
  <% if !params[:action].eql?("edit") && !params[:action].eql?("update") %>
    <script>
      $(function () {
          var costPriceProductDataTable = $('#listing_products_table').DataTable({
              order: [0, 'asc'],
              /*dom: 'T<"clear">lfrtip',*/
              columns: [
                  //{data: null, defaultContent: '', orderable: false},
                  {data: 'code'},
                  {data: 'brand'}
              ],
              /*
               tableTools: {
               sRowSelect: 'os',
               sRowSelector: 'td:first-child',
               aButtons: ['select_all', 'select_none']
               },*/
              paging: false,
              info: false,
              scrollY: "250px",
              scrollCollapse: true
          });

          $('#listing_products_table tbody').on('dblclick', 'tr', function () {
              if (!$(this).hasClass('selected')) {
                  costPriceProductDataTable.$('tr.selected').removeClass('selected');
                  $(this).addClass('selected');
                  var productId = $(this).attr("id").split("_")[1];
                  $.get("/cost_prices/generate_form", {
                      product_id: productId
                  });

              }
          });

    <% if @product.present? %>
            $("#product_<%= @product.id %>").addClass("selected");
    <% end %>

      });
    </script>
  <% end %>